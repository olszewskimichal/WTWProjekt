<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout"
>
<head>
    <title>Produkty</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.min.js"/>
    <script src="js/app.js"></script>
    <script src="js/productController.js"></script>
    <script src="js/productService.js"></script>

    <style>
        .name.ng-valid {
            background-color: lightgreen;
        }

        .name.ng-dirty.ng-invalid-required {
            background-color: red;
        }

        .name.ng-dirty.ng-invalid-minlength {
            background-color: yellow;
        }
    </style>
</head>
<body ng-app="myApp" class="ng-cloak">
<div layout:fragment="content">
    <div class="jumbotron">
        <h1 th:text="#{products}"></h1>
        <p>
            Dodaj nowy produkt
        </p>
    </div>
    <section class="container" ng-controller="ProductController as ctrl">
        <form action="#" th:action="@{/addProduct}" th:object="${productCreateForm}" method="post"
              class="form-horizontal" enctype="multipart/form-data" name="productForm">
            <fieldset>
                <legend>Dodaj nowy produkt</legend>
                <div th:if="${#fields.hasAnyErrors()}" class="alert alert-danger">
                    <p th:each="err:${#fields.allErrors()}" th:text="${err}">...</p>
                </div>

                <div class="form-group">
                    <label class="control-label col-lg-2 col-lg-2" for="name" th:text="#{product.name}"/>
                    <div class="col-lg-10">
                        <input id="name" type="text" class="name form:input-large" th:field="*{name}"
                               ng-minlength="4" ng-model="ctrl.product.name" required="required"
                               placeholder="Podaj nazwe produktu"/>
                        <span class="has-error" ng-show="productForm.name.$dirty">
                            <span ng-show="productForm.name.$error.minlength" th:text="#{Size.productCreateForm.name}"
                                  th:class="text-danger">name Error
                            </span>
                            <span ng-show="productForm.name.$error.required"
                                  th:text="#{NotBlank.productCreateForm.name}"
                                  th:class="text-danger">name Error
                            </span>
                        </span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-lg-2" for="unitPrice" th:text="#{product.unitPrice}"/>
                    <div class="col-lg-10">
                        <div class="form:input-prepend">
                            <input id="unitPrice" type="text" class="price form:input-large" th:field="*{price}"
                                   ng-pattern="/^\d{0,9}(\.\d{1,9})?$/" ng-model="ctrl.product.price"
                                   required="required"
                                   placeholder="Podaj cene produktu"/>
                            <span class="has-error" ng-show="productForm.price.$dirty">
                                <span ng-show="productForm.price.$error.pattern"
                                      th:text="#{Pattern.productCreateForm.price}"
                                      th:class="text-danger">price Error
                                </span>
                                <span ng-show="productForm.price.$error.required"
                                      th:text="#{NotNull.productCreateForm.price}"
                                      th:class="text-danger">price Error
                                </span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="control-label col-lg-2" for="description" th:text="#{product.description}"/>
                    <div class="col-lg-10">
                        <textarea id="description" path="description" rows="4" th:field="*{description}"
                                  ng-model="ctrl.product.description" required="required"
                                  placeholder="Podaj opis produktu"/>
                         <span class="has-error" ng-show="productForm.description.$dirty">
                                <span ng-show="productForm.description.$error.required"
                                      th:text="#{NotBlank.productCreateForm.description}"
                                      th:class="text-danger">description Error
                                </span>
                         </span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-lg-2" for="unitsInStock" th:text="#{product.unitsInStock}"/>
                    <div class="col-lg-10">
                        <input id="unitsInStock" type="text" class="form:input-large" th:field="*{unitsInStock}"
                               ng-model="ctrl.product.unitsInStock" ng-pattern="/^([0-9]|[1-9][0-9]*)$/"
                               required="required"/>
                          <span class="has-error" ng-show="productForm.unitsInStock.$dirty">
                                <span ng-show="productForm.unitsInStock.$error.pattern"
                                      th:text="#{Pattern.productCreateForm.unitsInStock}"
                                      th:class="text-danger">unitsInStock Error
                                </span>
                                <span ng-show="productForm.unitsInStock.$error.required"
                                      th:text="#{NotNull.productCreateForm.unitsInStock}"
                                      th:class="text-danger">unitsInStock Error
                                </span>
                            </span>
                    </div>
                </div>
                <div class="form-group">
                    <label class="control-label col-lg-2" for="imageURL" th:text="#{product.imageURL}"/>
                    <div class="col-lg-10">
                        <input id="imageURL" type="text" class="form:input-large" th:field="*{imageURL}"
                               ng-model="ctrl.product.imageURL"
                               placeholder="Podaj adres URL do zdjÄ™cia"/>
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-lg-offset-2 col-lg-10">
                        <input type="submit" id="btnAdd" class="btn btn-primary" value="Dodaj"/>
                    </div>
                </div>

            </fieldset>
        </form>
    </section>
</div>
</body>
<div layout:fragment="script">
    <script>
        document.getElementById("addProduct").className = 'active';
    </script>
</div>
</html>